# callitris = mean (callitris) * 100,
eucalyptus = mean (eucalyptus) * 100)
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
#group_by(time, lat, long, site.name) %>%
summarize(picea = mean (picea) * 100)
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
#group_by(time, lat, long, site.name) %>%
summarize(picea = mean(picea) * 100)
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
#group_by(time, lat, long, site.name) %>%
#summarize(picea = mean(picea) * 100)
timefltr_output <- dplyr::filter (interp_dl, time >= -21000, time < 0)
final_output <- na.omit(timefltr_output)
#write.csv(final_output, file = "FILE_PATH.csv")
#inputFile <- "FILE_PATH.csv"
#This section posts the file you just created and saved locally to R
#your carto info
#carto_acc = "username"
#carto_api = "api key"
#optional:
#test_connection()
#Post the file!
#local_import(inputFile)
#tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
#interp_dl <- data.frame(comp_dl[,1:10],
#time = - (round(comp_dl$age / 500, 0) * 500),
#picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
#group_by(time, lat, long, site.name) %>%
#summarize(picea = mean(picea) * 100)
#timefltr_output <- dplyr::filter (interp_dl, time >= -21000, time < 0)
#final_output <- na.omit(timefltr_output)
#picea_datasets <- get_dataset(taxonname = 'Picea*',
# loc = c(-130, 24, -34, 65),
#  ageyoung = 0,
#  ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
#picea_dataset_numbers <- as.numeric(names(picea_datasets))
#picea_datasets <- get_dataset(taxonname = 'Picea*',
# loc = c(-130, 24, -34, 65),
#  ageyoung = 0,
#  ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
#picea_dataset_numbers <- as.numeric(names(picea_datasets))
#picea_datasets <- get_dataset(taxonname = 'Picea*',
# loc = c(-130, 24, -34, 65),
#  ageyoung = 0,
#  ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
#picea_dataset_numbers <- as.numeric(names(picea_datasets))
#picea_datasets <- get_dataset(taxonname = 'Picea*',
# loc = c(-130, 24, -34, 65),
#  ageyoung = 0,
#  ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
#picea_dataset_numbers <- as.numeric(names(picea_datasets))
#library(neotoma)
#library(dplyr)
#library(httr)
#library(devtools)
#library(rCartoAPI)
#taxon_datasets <- get_dataset(taxonname = 'Taxon*',
# loc = c(-130, 24, -34, 65),
#  ageyoung = 0,
#  ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
#taxon_dataset_numbers <- as.numeric(names(taxon_datasets))
#site_dataset_numbers = list()
#site_dataset_numbers <- append(site_dataset_numbers, c(taxon_dataset_numbers))
#all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
#data_downloads <- get_download(all_dataset_numbers)
#saveRDS(data_downloads, file = "FILE_PATH")
#site_dataset_numbers = list()
#site_dataset_numbers <- append(site_dataset_numbers, c(taxon_dataset_numbers))
#all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
#data_downloads <- get_download(all_dataset_numbers)
#saveRDS(data_downloads, file = "FILE_PATH")
#site_dataset_numbers = list()
#site_dataset_numbers <- append(site_dataset_numbers, c(taxon_dataset_numbers))
#all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
#data_downloads <- get_download(all_dataset_numbers)
#saveRDS(data_downloads, file = "FILE_PATH")
#site_dataset_numbers = list()
#site_dataset_numbers <- append(site_dataset_numbers, c(taxon_dataset_numbers))
#all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
#data_downloads <- get_download(all_dataset_numbers)
#saveRDS(data_downloads, file = "FILE_PATH")
library(rmarkdown)
render('Pollen_Mapper.Rmd')
source('~/Desktop/Github/CartoAnimations/R/NAmerica.R', echo=TRUE)
source('~/Desktop/Github/CartoAnimations/R/NAmerica.R', echo=TRUE)
source('~/Desktop/Github/CartoAnimations/R/NAmerica.R', echo=TRUE)
source('~/Desktop/Github/CartoAnimations/R/NAmerica.R', echo=TRUE)
source('~/Desktop/Github/CartoAnimations/R/NAmerica.R', echo=TRUE)
source('~/Desktop/Github/CartoAnimations/R/linearInterpolation_NA.R', echo=TRUE)
source('~/Desktop/blub.R', echo=TRUE)
source('~/Desktop/blub.R', echo=TRUE)
source('~/Desktop/blub.R', echo=TRUE)
source('~/Desktop/blubinter.R', echo=TRUE)
?comp_dl
??comp_dl
comp_d?
?round
??round
?else
??else
?rowSums
str(interp_dl)
?vaccinium
??vaccinium
print(summary(interp_dl))
print(summary(interp_dl))
print(summary(interp_dl))
source('~/Desktop/Github/CartoAnimations/R/linearInterpolation_NA_BIN.R', echo=TRUE)
print(summary(interp_dl))
# Removes any observations from over 21,000 years ago
timefltr_output <- dplyr::filter(interp_dl, time >= -21000, time <= 0)
?breaks
??breaks
interp_dl <- data.frame(comp_dl[,1:10],
time = cut(comp_dl$age, breaks = -18000, -17000, -16000 -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000),
# time = - (round(comp_dl$age / 500, 0) * 500),
alnus = rowSums(comp_dl[, grep("Alnus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
fagus = rowSums(comp_dl[, grep("Fagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
pinus = rowSums(comp_dl[, grep("Pinus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
quercus = rowSums(comp_dl[, grep("Quercus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
tsuga = rowSums(comp_dl[, grep("Tsuga*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ulmus = rowSums(comp_dl[, grep("Ulmus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ambrosia = rowSums(comp_dl[, grep("Ambrosia*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
cyperaceae = rowSums(comp_dl[, grep("Cyperaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
poaceae = rowSums(comp_dl[, grep("Poaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)%>%
group_by(time, lat, long, site.name) %>%
summarize( alnus = mean ( alnus) * 100,
fagus = mean ( fagus) * 100,
picea = mean ( picea) * 100,
pinus = mean ( pinus) * 100,
quercus = mean (quercus) * 100,
tsuga = mean (tsuga) * 100,
ulmus = mean ( ulmus) * 100,
ambrosia = mean ( ambrosia) * 100,
cyperaceae = mean ( cyperaceae) * 100,
poaceae = mean ( poaceae) * 100)
# Removes any observations from over 21,000 years ago
timefltr_output <- dplyr::filter(interp_dl, time >= -21000, time <= 0)
final_output <- na.omit(timefltr_output)
#bins time according to ice sheet values
cut(interp_dl, breaks = c(-21000, -18000, -17000, -16000 -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000, 0))
# Removes any observations from over 21,000 years ago
timefltr_output <- dplyr::filter(interp_dl, time >= -21000, time <= 0)
#bins time according to ice sheet values
cut(time, breaks = c(-21000, -18000, -17000, -16000 -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000, 0))
#bins time values according to ice sheet intervals
cut(comp_dl$age, breaks = c(-21000, -18000, -17000, -16000 -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000, 0))
interp_dl <- data.frame(comp_dl[,1:10],
time = (comp_dl$age),
# time = - (round(comp_dl$age / 500, 0) * 500),
alnus = rowSums(comp_dl[, grep("Alnus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
fagus = rowSums(comp_dl[, grep("Fagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
pinus = rowSums(comp_dl[, grep("Pinus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
quercus = rowSums(comp_dl[, grep("Quercus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
tsuga = rowSums(comp_dl[, grep("Tsuga*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ulmus = rowSums(comp_dl[, grep("Ulmus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ambrosia = rowSums(comp_dl[, grep("Ambrosia*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
cyperaceae = rowSums(comp_dl[, grep("Cyperaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
poaceae = rowSums(comp_dl[, grep("Poaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)%>%
group_by(time, lat, long, site.name) %>%
summarize( alnus = mean ( alnus) * 100,
fagus = mean ( fagus) * 100,
picea = mean ( picea) * 100,
pinus = mean ( pinus) * 100,
quercus = mean (quercus) * 100,
tsuga = mean (tsuga) * 100,
ulmus = mean ( ulmus) * 100,
ambrosia = mean ( ambrosia) * 100,
cyperaceae = mean ( cyperaceae) * 100,
poaceae = mean ( poaceae) * 100)
# Removes any observations from over 21,000 years ago
timefltr_output <- dplyr::filter(interp_dl, time >= -21000, time <= 0)
interp_dl <- data.frame(comp_dl[,1:10],
time,
alnus = rowSums(comp_dl[, grep("Alnus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
fagus = rowSums(comp_dl[, grep("Fagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
pinus = rowSums(comp_dl[, grep("Pinus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
quercus = rowSums(comp_dl[, grep("Quercus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
tsuga = rowSums(comp_dl[, grep("Tsuga*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ulmus = rowSums(comp_dl[, grep("Ulmus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ambrosia = rowSums(comp_dl[, grep("Ambrosia*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
cyperaceae = rowSums(comp_dl[, grep("Cyperaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
poaceae = rowSums(comp_dl[, grep("Poaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)%>%
group_by(time, lat, long, site.name) %>%
summarize( alnus = mean ( alnus) * 100,
fagus = mean ( fagus) * 100,
picea = mean ( picea) * 100,
pinus = mean ( pinus) * 100,
quercus = mean (quercus) * 100,
tsuga = mean (tsuga) * 100,
ulmus = mean ( ulmus) * 100,
ambrosia = mean ( ambrosia) * 100,
cyperaceae = mean ( cyperaceae) * 100,
poaceae = mean ( poaceae) * 100)
interp_dl <- data.frame(comp_dl[,1:11],
time,
alnus = rowSums(comp_dl[, grep("Alnus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
fagus = rowSums(comp_dl[, grep("Fagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
picea = rowSums(comp_dl[, grep("Picea*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
pinus = rowSums(comp_dl[, grep("Pinus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
quercus = rowSums(comp_dl[, grep("Quercus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
tsuga = rowSums(comp_dl[, grep("Tsuga*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ulmus = rowSums(comp_dl[, grep("Ulmus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
ambrosia = rowSums(comp_dl[, grep("Ambrosia*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
cyperaceae = rowSums(comp_dl[, grep("Cyperaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
poaceae = rowSums(comp_dl[, grep("Poaceae*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)%>%
group_by(time, lat, long, site.name) %>%
summarize( alnus = mean ( alnus) * 100,
fagus = mean ( fagus) * 100,
picea = mean ( picea) * 100,
pinus = mean ( pinus) * 100,
quercus = mean (quercus) * 100,
tsuga = mean (tsuga) * 100,
ulmus = mean ( ulmus) * 100,
ambrosia = mean ( ambrosia) * 100,
cyperaceae = mean ( cyperaceae) * 100,
poaceae = mean ( poaceae) * 100)
cut(time, breaks = c(-18000, -17000, -16000, -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000, 0))
cut(,time, breaks = c(-18000, -17000, -16000, -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000, 0))
cut(time, breaks = c(-18000, -17000, -16000, -15000, -14000, -13500, -12750, -12000, -11000, -10250, -10000, -9000, -8000, -7000 -6000, -5000, 0))
library(rmarkdown)
render('Pollen_Mapper.Rmd')
library(neotoma)
library(dplyr)
library(httr)
library(devtools)
library(rCartoAPI)
nothofagus_datasets <- get_dataset(taxonname = 'Nothofagus*',
loc = c(105, -51, 177, 10),
ageyoung = 0,
ageold = 21000)
eucalyptus_datasets <- get_dataset(taxonname = 'Eucalyptus*',
loc = c(105, -51, 177, 10),
ageyoung = 0,
ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
nothofagus_dataset_numbers <- as.numeric(names(nothofagus_datasets))
eucalyptus_dataset_numbers <- as.numeric(names(eucalyptus_datasets))
site_dataset_numbers = list()
site_dataset_numbers <- append(site_dataset_numbers, c(nothofagus_dataset_numbers,
eucalyptus_dataset_numbers))
all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
data_downloads <- get_download(all_dataset_numbers)
saveRDS(data_downloads, file = "FILE_PATH")
data_downloads <- readRDS("FILE_PATH.")
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
library(neotoma)
library(dplyr)
library(httr)
library(devtools)
library(rCartoAPI)
nothofagus_datasets <- get_dataset(taxonname = 'Nothofagus*',
loc = c(105, -51, 177, 10),
ageyoung = 0,
ageold = 21000)
eucalyptus_datasets <- get_dataset(taxonname = 'Eucalyptus*',
loc = c(105, -51, 177, 10),
ageyoung = 0,
ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
nothofagus_dataset_numbers <- as.numeric(names(nothofagus_datasets))
eucalyptus_dataset_numbers <- as.numeric(names(eucalyptus_datasets))
site_dataset_numbers = list()
site_dataset_numbers <- append(site_dataset_numbers, c(nothofagus_dataset_numbers,
eucalyptus_dataset_numbers))
all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
data_downloads <- get_download(all_dataset_numbers)
library(neotoma)
library(dplyr)
library(httr)
library(devtools)
library(rCartoAPI)
nothofagus_datasets <- get_dataset(taxonname = 'Nothofagus*',
loc = c(105, -51, 177, 10),
ageyoung = 0,
ageold = 21000)
eucalyptus_datasets <- get_dataset(taxonname = 'Eucalyptus*',
loc = c(105, -51, 177, 10),
ageyoung = 0,
ageold = 21000)
#can_datasets <- neotoma::get_dataset(datasettype = 'pollen',
#ageold = 15000, ageyoung = -100,
#gpid = "Canada")
nothofagus_dataset_numbers <- as.numeric(names(nothofagus_datasets))
eucalyptus_dataset_numbers <- as.numeric(names(eucalyptus_datasets))
site_dataset_numbers = list()
site_dataset_numbers <- append(site_dataset_numbers, c(nothofagus_dataset_numbers,
eucalyptus_dataset_numbers))
all_dataset_numbers <- as.numeric(unique(site_dataset_numbers))
data_downloads <- get_download(all_dataset_numbers)
saveRDS(data_downloads, file = "~/Desktop/Neotoma.RData")
data_downloads <- readRDS("~/Desktop/Neotoma.RData")
comp_dl <- compile_downloads(data_downloads)
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
group_by(time, lat, long, site.name) %>%
summarize( nothofagus = mean ( nothofagus) * 100,
eucalyptus = mean ( eucalyptus) * 100)
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
group_by(time, lat, long, site.name) %>%
summarize( nothofagus = mean ( nothofagus) * 100,
eucalyptus = mean (eucalyptus) * 100)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
casuarina = rowSums(comp_dl[, grep("Casuarina*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
#callitris = rowSums(comp_dl[, grep("Callitris*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
phyllocladus = rowSums(comp_dl[, grep("Phyllocladus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts) %>%
group_by(time, lat, long, site.name) %>%
summarize( nothofagus = mean ( nothofagus) * 100,
phyllocladus = mean ( phyllocladus) * 100,
casuarina = mean (casuarina) * 100,
# callitris = mean (callitris) * 100,
eucalyptus = mean (eucalyptus) * 100)
group_by(time, lat, long, site.name) %>%
summarize( nothofagus = mean ( nothofagus) * 100,
eucalyptus = mean (eucalyptus) * 100)
?group_by
group_by(time, lat, long, site.name) %>%
summarize(nothofagus = mean (nothofagus) * 100, eucalyptus = mean (eucalyptus) * 100)
library(dplyr)
dplyr::group_by(time, lat, long, site.name) %>%
summarize(nothofagus = mean (nothofagus) * 100, eucalyptus = mean (eucalyptus) * 100)
View(interp_dl)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)
View(interp_dl)
dplyr::group_by(time, lat, long, site.name) %>%
summarize(nothofagus = mean (nothofagus) * 100, eucalyptus = mean (eucalyptus) * 100)
View(interp_dl)
class(interp_dl)
dplyr::group_by(time, lat, long, site.name) %>% summarize(nothofagus = mean (nothofagus) * 100, eucalyptus = mean (eucalyptus) * 100)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
casuarina = rowSums(comp_dl[, grep("Casuarina*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
#callitris = rowSums(comp_dl[, grep("Callitris*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
phyllocladus = rowSums(comp_dl[, grep("Phyllocladus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts) %>%
group_by(time, lat, long, site.name) %>%
summarize( nothofagus = mean ( nothofagus) * 100,
phyllocladus = mean ( phyllocladus) * 100,
casuarina = mean (casuarina) * 100,
# callitris = mean (callitris) * 100,
eucalyptus = mean (eucalyptus) * 100)
interp_dl <- data.frame(comp_dl[,1:10],
time = - (round(comp_dl$age / 500, 0) * 500),
nothofagus = rowSums(comp_dl[, grep("Nothofagus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts,
eucalyptus = rowSums(comp_dl[, grep("Eucalyptus*", colnames(comp_dl))], na.rm = TRUE) / tot_cnts)  %>%
dplyr::group_by(time, lat, long, site.name) %>%
summarize(nothofagus = mean (nothofagus) * 100, eucalyptus = mean (eucalyptus) * 100)
write.csv(final_output, file = "~/Desktop/Neotoma.csv")
inputFile <- "~/Desktop/Neotoma.csv"
#This section posts the file you just created and saved locally to R
#our carto info
carto_acc = "username"
carto_api = "api key"
#optional:
#test_connection()
#Post the file!
local_import(inputFile)
httr
library(httr)
?httr
install.packages("httr")
install.packages("httr")
library(httr)
r <- GET("/api/open/v1/DisasterDeclarationsSummaries?$orderby=state")
r <- GET("http://httpbin.org/get")
status_code(r)
headers(r)
http_status(r)
View(interp_dl)
# Gets total counts for each observation at each site
tot_cnts <- rowSums(comp_dl[,11:ncol(comp_dl)], na.rm=TRUE)
?round
View(final_output)
?repeat
?repeat
?repeat()
legendvalues <- rep(c(10, 50, 100), times = length(final_output[,1]))
legendvalues <- rep(c(10, 50, 100), times = length.out(final_output[,1]))
legendvalues <- rep(c(10, 50, 100), length.out = final_output[,1])
length(final_output[,1])
length(final_output)
legendvalues <- rep(c(10, 50, 100), length.out = nrow(final_output[,1]))
final_output$legendvalues = legendvalues
View(final_output)
max(final_output[,5:14])
max(final_output[,5:13])
View(interp_dl)
View(interp_dl)
View(comp_dl)
View(comp_dl)
?sequence
# Creates data for legend
time_bins <- seq(0, -21000, 500)
# Creates data for legend
time_bins <- seq(0, -21000, -500)
data.frame(rep(time_bins, each = 3), rep(c(10, 50, 100),length.out = nrow(time_bins))
timebar <- data.frame(rep(time_bins, each = 3), rep(c(10, 50, 100),length.out = nrow(time_bins))
timebar <- data.frame(rep(time_bins, each = 3), rep(c(10, 50, 100),length.out = nrow(time_bins)))
timebar <- data.frame(rep(time_bins, each = 3), rep(c(10, 50, 100),length.out = time_bins))
length(time_bins)
timebar <- data.frame(rep(time_bins, each = 3), rep(c(10, 50, 100),length.out = length(time_bins)))
View(timebar)
timebar <- data.frame(rep(time_bins, each = 3), rep(0,length.out = length(time_bins)), rep(c(10, 50, 100),length.out = length(time_bins)))
timebar <- data.frame(rep(time_bins, each = 3), rep(0,length.out = length(time_bins)), rep(0,length.out = length(time_bins)), rep("legendsite",length.out = length(time_bins)), rep(c(10, 50, 100),length.out = length(time_bins)))
View(timebar)
legenddata <- data.frame(rep(time_bins, each = 3), rep(0,length.out = length(time_bins)), rep(0,length.out = length(time_bins)), rep("legendsite",length.out = length(time_bins)), rep(c(10, 50, 100),length.out = length(time_bins)))
View(legenddata)
head(legenddata) <- c("time", "lat", "long", "site.name", "legendvalues")
names(legenddata) <- c("time", "lat", "long", "site.name", "legendvalues")
View(legenddata)
#
interp_dl_legend <- rbind(interp_dl,legenddata)
View(interp_dl)
View(final_output)
View(interp_dl)
comp_dl_legend <- rbind(comp_dl,legenddata)
View(comp_dl)
View(comp_dl)
View(legenddata)
View(interp_dl)
# Creates table for legend
time_bins <- seq(0, -21000, -500)
legenddata <- data.frame(rep(time_bins, each = 3), rep(0,length.out = length(time_bins)), rep(0,length.out = length(time_bins)), rep("legendsite",length.out = length(time_bins)), rep(0, 5:ncol(interp_dl)), rep(c(10, 50, 100),length.out = length(time_bins)))
ncol(interp_dl)
ncol(interp_dl)-5
legenddata <- data.frame(rep(time_bins, each = 3), rep(0,length.out = length(time_bins)), rep(0,length.out = length(time_bins)), rep("legendsite",length.out = length(time_bins)), rep(0, ncol(interp_dl)-4), rep(c(10, 50, 100),length.out = length(time_bins)))
test <- data.frame[5,4]
test <- data.frame(5,4)
View(test)
View(test)
test <- data.frame(c(5,4))
View(test)
View(test)
test <- data.frame(5,4)
legenddata <- data.frame(c(rep(time_bins, each = 3), rep(0,length.out = length(time_bins)), rep(0,length.out = length(time_bins)), rep("legendsite",length.out = length(time_bins)), rep(0, ncol(interp_dl)-4), rep(c(10, 50, 100),length.out = length(time_bins))))
# Creates table for legend
time_bins <- rep(seq(0, -21000, -500), each = 3)
blank_pollen <- data.frame(rep(0, ncol(interp_dl)-4)
)
View(blank_pollen)
blank_pollen <- data.frame(rep(0, length.out(ncol(interp_dl)-4)),  rep(0,length.out = length(time_bins)))
blank_pollen <- data.frame(rep(0, length.out = ncol(interp_dl)-4),  rep(0,length.out = length(time_bins)))
testtest <- rep(blank_pollen, length.out = length(time_bins))
View(testtest)
View(blank_pollen)
blank_pollen <- c(rep(0, length.out = ncol(interp_dl)-4))
testtest <- rep(blank_pollen, length.out = length(time_bins))
blank_pollen <- matrix(0, ncol = 5:ncol(interp_dl), nrow = 2)
blank_pollen <- as.data.frame(matrix(0, ncol = 5:ncol(interp_dl), nrow = length(time_bins)))
View(interp_dl)
# Add blank legendvalues column
legendvalues <- rep(0,length.out = length(interp_dl)
)
# Add blank legendvalues column
legendvalues <- rep(0,length.out = length(interp_dl))
blank_pollen <- as.data.frame(matrix(0, ncol = ncol(interp_dl, nrow = nrow(time_bins)))
# Add blank legendvalues column
legendvalues <- rep(0,length.out = length(interp_dl))
# Add blank legendvalues column
legendvalues <- rep(0,length.out = nrow(interp_dl))
interp_dl$legendvalues <- rep(0,length.out = nrow(interp_dl))
interp_dl$legendvalues <- rep(NULL,length.out = nrow(interp_dl))
?filter
